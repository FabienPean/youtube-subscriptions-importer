<!DOCTYPE html>
<html>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

    <meta charset="utf-8">
    <title></title>
</head>

<body>
    <script src = "authentication.js"></script>

    <button id="sign-in-or-out-button" style="margin-left: 25px">Sign In/Authorize</button>
    <button id="revoke-access-button" style="display: none; margin-left: 25px">Revoke access</button>


    <div id="auth-status" style="display: inline; padding-left: 25px"></div>
    <hr>

    <script async defer src="https://apis.google.com/js/api.js" onload="this.onload=function(){};handleClientLoad()" onreadystatechange="if (this.readyState === 'complete') this.onload()">
    </script>
    <button id="add-subscription" style="margin-left: 25px">Add Subscription</button>
    <input id="subscription-id" type="text" name="" value="">
    <br>
    <p id="demo">example text</p>

    <input id= "input-file" type="file" name="browsename[]">
    <button id="import" style="margin-left: 25px">Import!</button>
    <script>
    console.log("script")
    $('#import').click(function() {

      //have to use old school school selector, can't figure out the jquery...
      var selectedFile = document.getElementById('input-file').files[0];
      handleXML(selectedFile);

      console.log(selectedFile);
      //console.log("pressed");
    });
    function handleXML(file){

    $.get(window.URL.createObjectURL(file), function(data) {
        //var xmlDoc = data.responseXML;
        console.log("get worked");
        var regex = /(UC)[A-Za-z0-9\-_]+/g;
        var x = $(data);
        console.log(x);
        var outline = x.find("outline[xmlUrl]")
        console.log(outline);
        var count = 0;
        $(outline).each(function(){
          count +=1;
          var title = $(this).attr("title");
          var url = $(this).attr("xmlUrl")+"";
          console.log(url.match(regex)[0]);

          //console.log(myRe.exec(url));
        });
    });
  }
    console.log("end of subscriptions");

    </script>

</body>

</html>
